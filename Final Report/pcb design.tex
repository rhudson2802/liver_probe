\section{PCB Design}
The PCB designs were produced using KiCAD \cite{kicad}. This is an integrated CAD package which allows schematics, PCB layouts and PCB footprints to be designed within one project. The PCBs were manufactured by an external company, JLCPCB \cite{pcb_house}, which produced high-quality boards for low cost. The first step in the PCB design was to specify the design rules for the PCB layout according to the tolerances set by JLCPCB. These included restrictions such as the minimum track width, hole size and clearances allowed. A 2-layer design was selected so that none of the traces ran through an inaccessible middle layer, which meant debugging would be easier. Furthermore, it meant that if any errors were made in the design, it would be easier to fix them as the traces could be cut and new connections soldered on. After the traces had been routed, the remaining board area was filled with power planes. The \SI{+5}{\volt} plane was on the top layer, and the ground plane was on the bottom layer. Using power planes was advantageous as it lowered the resistance of the path from the power node to the components, so there was a smaller voltage drop across the trace. Furthermore, the copper planes act to shield the circuit from electromagnetic interference and also stop any emissions from the board. Finally, using wide planes helps to lower the loop inductance, so there is less likelihood of ringing or voltage spikes. The other traces on the board were made as wide as possible to lower the resistance and make them easier to modify if any errors were made. Once the designs were produced, Gerber and drill files were generated, and these were sent to the board house for manufacture.\\


\subsection{Remote Unit}
The main restriction on the remote unit was that it had to be handheld, meaning the PCB should be made as small as possible. For this reason, many of the components were made surface mount, as generally these had a smaller footprint and did not waste board space with through-holes. Standard 0805 packages were used for the resistors and capacitors, and SOIC packages were used for the op-amps and PIC.\\

\begin{figure}[htb]
	\centering
	\includegraphics[width=0.8\linewidth]{old remote pcb.png}
	\caption{First version of the remote unit PCB.}
	\label{fig: old remote pcb}
\end{figure}

A first iteration of the design was manufactured (figure \ref{fig: old remote pcb}). This was useful for testing the basic functionality of the circuit and highlighted several issues which were resolved in the second iteration. Several additional test points and sockets for receiver modules were included for testing purposes, and these were removed from the final design. Additionally, an error was made in the differential amplifier circuits as they were connected to \SI{0}{\volt} rather than the \SI{2.5}{\volt} ``pseudo-ground'' rail. \\
%Take out mistake about 0V rail

Figure \ref{fig: remote pcb} shows the revised PCB design. In addition to removing many test points, the positions of the LEDs and phototransistors were changed to be more reflective of their intended positions in the probe. They were soldered to surface mount pads to ensure that they pointed in the correct direction and were accurately aligned to the front/back of the probe. They were covered with black electrical tape to block any cross-talk, which ensured that the signals measured were solely due to the reflectance of the object they were pointed at. Additionally, the battery footprints were changed to use slots rather than circular holes, as these were a better fit for the battery pins. This design measured \SI{53x38}{\milli\metre}, which was small enough to fit in a hand.

\begin{figure}[htb]
	\centering
	\includegraphics[width=0.8\linewidth]{remote pcb.png}
	\caption{Final version of the remote unit PCB.}
	\label{fig: remote pcb}
	\vspace{-8mm}
\end{figure}




\FloatBarrier
\subsection{Base Unit}
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.8\linewidth]{base pcb.png}
	\caption{Base unit PCB.}
	\label{fig: base pcb}
\end{figure}

The shape of the base unit was designed to fit within the selected enclosure (see section \ref{base casing}). The final design is shown in figure \ref{fig: base pcb}. There was a lot more space on the base unit so more through-hole components could be used. Specifically, some of the power components needed a through-hole package because the thermal rating of the surface mount alternatives was too small. The PIC also had a through-hole package so that it could be easily transferred to a breadboard for testing. Many components were connected via header sockets, which allowed flexibility during testing. In the commercial version, these components should be mounted directly on the PCB to ensure they do not accidentally disconnect. Any components which cannot be soldered directly should use terminal blocks rather than header sockets to make a stronger connection. 